results = {
    "original": {
        "precision": [
            0.8812789230122002,
            0.8686564736499675,
            0.8688737422914639,
            0.8840091039366096,
            0.8837052062204191,
            0.8789552988448016,
            0.8765791223404256,
            0.8755371900826446,
            0.8771755345599205,
            0.8725393700787402,
        ],
        "recall": [
            0.9220070422535211,
            0.9402288732394366,
            0.9426056338028169,
            0.9231514084507042,
            0.9204225352112676,
            0.9242957746478874,
            0.9284330985915493,
            0.9325704225352113,
            0.9316901408450704,
            0.9364436619718309,
        ],
        "f1-score": [
            0.9011830501183049,
            0.9030267162664863,
            0.9042391487924337,
            0.9031563536149507,
            0.9016902380131079,
            0.9010555221831288,
            0.9017612859097127,
            0.903154305200341,
            0.9036113719798514,
            0.9033627717391304,
        ],
        "auroc": [
            0.7703278454510849,
            0.751871193376475,
            0.75292443852303,
            0.7756297582794062,
            0.7742653216596879,
            0.7667424819185383,
            0.7635408736200989,
            0.7627716977540921,
            0.765574800152265,
            0.7582218309859154,
        ],
        "dp": [
            0.19085482487426686,
            0.15941302984535632,
            0.15846615108003936,
            0.18667900206071097,
            0.1933592072776873,
            0.18000970909795766,
            0.17304476224735543,
            0.169062110404692,
            0.1742254119882466,
            0.16180794869860438,
        ],
        "ftu": [
            0.026228419654714452,
            0.04355909694555116,
            0.023970783532536566,
            0.03585657370517925,
            0.042363877822045204,
            0.027290836653386497,
            0.027290836653386386,
            0.023373173970783423,
            0.013545816733067761,
            0.037782204515272255,
        ],
        "dp-f1": [
            0.8526876960172648,
            0.8706888427254593,
            0.8717603631451829,
            0.8558878171648391,
            0.8515212980329123,
            0.8586137267657626,
            0.8627397359582893,
            0.8655423680406166,
            0.8629413279416462,
            0.8695580348040715,
        ],
        "dp-auroc": [
            0.7892595204748951,
            0.793757905683953,
            0.794766982223535,
            0.7940283442596393,
            0.790121547584898,
            0.7924729375542162,
            0.7939838647368999,
            0.7953969905256767,
            0.7945360332432011,
            0.796203940478144,
        ],
        "ftu-f1": [
            0.936072189306372,
            0.9289666343355051,
            0.9387636831012621,
            0.9326539537174169,
            0.9288214930141239,
            0.9355123083278805,
            0.935892551737588,
            0.9384547039532091,
            0.9432172502828465,
            0.9318619093886573,
        ],
        "ftu-auroc": [
            0.8601841756886872,
            0.8419074765975583,
            0.8500820686195646,
            0.8596733635330092,
            0.856243226552283,
            0.8575316711096034,
            0.8555256311556099,
            0.8565527588722959,
            0.8620912911384803,
            0.8481257086554447,
        ],
    },
    "decaf_nd": {
        "precision": [
            0.8893718306944013,
            0.8420448525516511,
            0.903769401330377,
            0.8874974752575238,
            0.8894088920541255,
            0.8736668605778554,
            0.8796863250617681,
            0.9157183098591549,
            0.9149481663136774,
            0.8766572920851747,
        ],
        "recall": [
            0.7565140845070423,
            0.839524647887324,
            0.717605633802817,
            0.7735915492957747,
            0.7695422535211267,
            0.7932218309859155,
            0.720862676056338,
            0.7154049295774648,
            0.7225352112676057,
            0.7683098591549296,
        ],
        "f1-score": [
            0.8175807448984446,
            0.840782861676805,
            0.8,
            0.8266390744050418,
            0.8251451224692057,
            0.8315031835378794,
            0.7923944070830713,
            0.8032616753150481,
            0.8074369189907038,
            0.8189153687370989,
        ],
        "auroc": [
            0.7337975827940617,
            0.6780055671869052,
            0.7415055196041112,
            0.7362552341073468,
            0.7378792348686714,
            0.7205298344118767,
            0.7090799866768176,
            0.7566213837076514,
            0.7581594975256948,
            0.7182089836315189,
        ],
        "dp": [
            0.35002142,
            0.20002687,
            0.41278568,
            0.32072788,
            0.337287,
            0.31335497,
            0.3550014,
            0.4125752,
            0.41580215,
            0.354074,
        ],
        "ftu": [
            0.062018633,
            0.07270914,
            0.098140776,
            0.03047812,
            0.04900396,
            0.11387783,
            0.043824673,
            0.16593623,
            0.14787513,
            0.10776889,
        ],
        "dp-f1": [
            0.7242091842134581,
            0.8198704755799785,
            0.6772874957264337,
            0.7457450033812674,
            0.7350625537193658,
            0.752163094167365,
            0.7111392431641622,
            0.6785941247950847,
            0.6779119380225594,
            0.7222061571378885,
        ],
        "dp-auroc": [
            0.689349510351312,
            0.7339567706119352,
            0.655401758691174,
            0.7066167254989341,
            0.6982791219274423,
            0.7031794592667897,
            0.6755229820707865,
            0.661373361495391,
            0.6599064679980928,
            0.6801524204444525,
        ],
        "ftu-f1": [
            0.8736523755867267,
            0.8819205353880749,
            0.8478813863875924,
            0.8923973852010509,
            0.8836119121299577,
            0.8579442573756914,
            0.8666145440416569,
            0.8183729905268351,
            0.8291792256523848,
            0.8540025956317686,
        ],
        "ftu-auroc": [
            0.8234204168333076,
            0.783292548252746,
            0.8138589988034014,
            0.8369388390496264,
            0.8309911823788512,
            0.7947924724605163,
            0.8142953007292838,
            0.7934574377667691,
            0.8024005899008023,
            0.795817739726205,
        ],
    },
    "decaf_ftu": {
        "precision": [
            0.9108531376629065,
            0.8693736832024517,
            0.8784541865780179,
            0.8816052842273819,
            0.889666900070021,
            0.8696833427018924,
            0.8705688375927453,
            0.9126095153598758,
            0.8993629197710831,
            0.8994953291098464,
        ],
        "recall": [
            0.7321302816901408,
            0.7991197183098592,
            0.7443661971830986,
            0.7754401408450704,
            0.7829225352112676,
            0.8171654929577464,
            0.7436619718309859,
            0.7243838028169014,
            0.7331866197183099,
            0.737411971830986,
        ],
        "f1-score": [
            0.8117710214240398,
            0.8327676359966976,
            0.8058705803869246,
            0.825121768452604,
            0.8328885143044436,
            0.8426068802759371,
            0.8021268515001899,
            0.8076753202139667,
            0.8078172736530721,
            0.8104290620616262,
        ],
        "auroc": [
            0.7560651408450704,
            0.7152355348306053,
            0.7140749904834411,
            0.7278552055576704,
            0.7424072135515798,
            0.7206097735059002,
            0.7021012561857632,
            0.7557054149219642,
            0.740647363913209,
            0.7422194994290064,
        ],
        "dp": [
            0.36348072,
            0.25572854,
            0.2980827,
            0.24811667,
            0.31408435,
            0.23075002,
            0.29855222,
            0.33695394,
            0.3023342,
            0.31775182,
        ],
        "ftu": [
            0.008831322,
            0.034462154,
            0.03353256,
            0.020849884,
            0.07742363,
            0.0019255877,
            0.021646738,
            0.014077067,
            0.045418322,
            0.026626825,
        ],
        "dp-f1": [
            0.713541901045994,
            0.7860365473804787,
            0.7503104452311367,
            0.7868018976578927,
            0.7522908872756247,
            0.8042591620534809,
            0.7484165927951312,
            0.7282493433705812,
            0.7487118240361724,
            0.7408349707407329,
        ],
        "dp-auroc": [
            0.6911610285663118,
            0.7294646708164307,
            0.7079439476229079,
            0.7396741813935097,
            0.7130442829593793,
            0.7441358839951737,
            0.7017743684200223,
            0.7063499246255716,
            0.718514371784758,
            0.7109714149092201,
        ],
        "ftu-f1": [
            0.8925445596766389,
            0.8942514801434993,
            0.8788929288723992,
            0.895561342415982,
            0.8754413354141681,
            0.9137751008183802,
            0.8815188844107161,
            0.8879420116000944,
            0.8750885466039063,
            0.8844589301874115,
        ],
        "ftu-auroc": [
            0.8577994290030977,
            0.8217490657409561,
            0.8213184214110707,
            0.8350056090514679,
            0.8227436693029301,
            0.8369451259786326,
            0.8175205538676111,
            0.8555984977274884,
            0.8341154922932328,
            0.8422238697653114,
        ],
    },
    "decaf_cf": {
        "precision": [
            0.7678253464426724,
            0.7818690625230135,
            0.804380332483068,
            0.7614265672303034,
            0.763652061299374,
            0.7790800353215059,
            0.7715868361029652,
            0.790722065348931,
            0.7882409561241678,
            0.7634133878385284,
        ],
        "recall": [
            0.8730633802816902,
            0.9345950704225352,
            0.8050176056338029,
            0.9077464788732394,
            0.9343309859154929,
            0.8543133802816901,
            0.8338028169014085,
            0.8627640845070422,
            0.8650528169014085,
            0.9205985915492958,
        ],
        "f1-score": [
            0.8170696544054044,
            0.8514375075183448,
            0.8046988428879406,
            0.828173312452315,
            0.8404133180252583,
            0.8149641012722004,
            0.8014892536808259,
            0.8251736476531256,
            0.8248625508876485,
            0.8346701783790256,
        ],
        "auroc": [
            0.5312614198705747,
            0.5670272649409973,
            0.6019682622763609,
            0.5172516178149982,
            0.5232465740388275,
            0.5552647982489531,
            0.5379824895317853,
            0.5808415017129807,
            0.5757696516939474,
            0.5223263228016749,
        ],
        "dp": [
            0.0054701567,
            0.02088797,
            0.11331785,
            0.033565998,
            0.039951384,
            0.028750956,
            0.055953622,
            0.058122337,
            0.04407847,
            0.0123848915,
        ],
        "ftu": [
            0.02450198,
            0.0065737367,
            0.0333333,
            0.08127487,
            0.031606913,
            0.043758333,
            0.021115541,
            0.02290839,
            0.020916283,
            0.069322705,
        ],
        "dp-f1": [
            0.8971079495235439,
            0.9108223393599306,
            0.8437035820630968,
            0.8919776958755686,
            0.8962562635332062,
            0.8862694872985828,
            0.8669465271982407,
            0.8796718263779987,
            0.8855693179463368,
            0.9047242873694048,
        ],
        "dp-auroc": [
            0.6925656862956769,
            0.7181542026207798,
            0.7170985334021057,
            0.6738483467869679,
            0.6773326747012542,
            0.7065778108632181,
            0.6853853279420138,
            0.7185588109938589,
            0.718670464528961,
            0.6832812945859343,
        ],
        "ftu-f1": [
            0.8892828334424001,
            0.9169678487045531,
            0.8782778659176164,
            0.8711023111708175,
            0.8998756807676996,
            0.8799684879158705,
            0.8813490883742574,
            0.8947298347502561,
            0.8953808732159014,
            0.8800630985558652,
        ],
        "ftu-auroc": [
            0.6878927711940652,
            0.7219693080398184,
            0.7419223557254698,
            0.661865954432856,
            0.6793978175852393,
            0.7025670727405776,
            0.6943558215690746,
            0.7285747428951131,
            0.7251187823093209,
            0.6691204938599521,
        ],
    },
    "decaf_dp": {
        "precision": [
            0.756461379412199,
            0.7680686573515852,
            0.7601659751037344,
            0.7558511773493634,
            0.7554678848283499,
            0.7855421686746988,
            0.7608868404322949,
            0.7609948216760265,
            0.7605356737534993,
            0.7555634301913536,
        ],
        "recall": [
            0.9017605633802817,
            0.9532570422535211,
            0.8869718309859155,
            0.9352992957746479,
            0.9608274647887324,
            0.9183098591549296,
            0.8428697183098591,
            0.9184859154929578,
            0.8848591549295775,
            0.938468309859155,
        ],
        "f1-score": [
            0.8227451610312424,
            0.850701127302722,
            0.81868779199675,
            0.8360546091198804,
            0.8458617482951023,
            0.8467532467532468,
            0.7997828265953892,
            0.83235610865143,
            0.8180005696382797,
            0.8371417353749508,
        ],
        "auroc": [
            0.5052046060144652,
            0.5347366292348688,
            0.5138913208983631,
            0.5038658641035402,
            0.5029812999619337,
            0.5742900647125999,
            0.5148132375333079,
            0.5164051199086411,
            0.514726874762086,
            0.5031530738484964,
        ],
        "dp": [
            0.017758608,
            0.015861511,
            0.0014628172,
            0.018490255,
            0.014605641,
            0.014897227,
            0.025756001,
            0.0452891,
            0.006875932,
            0.0018376112,
        ],
        "ftu": [
            0.042098284,
            0.017330706,
            0.0029216409,
            0.027755678,
            0.006241679,
            0.0707171,
            0.0029880404,
            0.025099576,
            0.010557771,
            0.0055776834,
        ],
        "dp-f1": [
            0.8954463964579621,
            0.9125677410545614,
            0.8997127078418482,
            0.9029619714865282,
            0.9103122078892556,
            0.9107036386225261,
            0.8784349908372471,
            0.8893448830601395,
            0.8970956900291417,
            0.9105884777786132,
        ],
        "dp-auroc": [
            0.6672280891435834,
            0.6929534784615419,
            0.6785637675854667,
            0.6658911763195363,
            0.6660078490515037,
            0.7255833443788537,
            0.6736526909552059,
            0.6702633786358179,
            0.6780347224483447,
            0.6690512242363156,
        ],
        "ftu-f1": [
            0.8851940402521526,
            0.9119355984050241,
            0.8991200543927417,
            0.8990209889813758,
            0.9138649493331973,
            0.8861005623650714,
            0.8875727482156323,
            0.8980067951249239,
            0.895590507933355,
            0.9090290049073523,
        ],
        "ftu-auroc": [
            0.6615190595398154,
            0.692588921471224,
            0.6782266008175006,
            0.6637454711548464,
            0.6679075573491445,
            0.7098796667770826,
            0.6790136263717319,
            0.675171593771609,
            0.6771745345183998,
            0.6682089576041176,
        ],
    },
    "decaf_cf-y": {
        "precision": [
            0.7573238586847222,
            0.7546258503401361,
            0.7546554934823091,
            0.7520891364902507,
            0.7539543057996485,
            0.7643429544003971,
            0.7827171694261738,
            0.7537834289268192,
            0.7537993920972644,
            0.7544188537761114,
        ],
        "recall": [
            0.9944542253521127,
            0.9764964788732394,
            0.998855633802817,
            0.9744718309859155,
            0.9818661971830986,
            0.9487676056338028,
            0.9113556338028169,
            0.9602112676056338,
            0.9605633802816902,
            0.9919014084507042,
        ],
        "f1-score": [
            0.8598394032804354,
            0.8513430544896393,
            0.8597514774965904,
            0.8489589324744047,
            0.8529479238357421,
            0.8466281764266917,
            0.8421523569365925,
            0.8445666060160273,
            0.8447128038396037,
            0.8570124733799818,
        ],
        "auroc": [
            0.5080379234868672,
            0.5008158070041873,
            0.500914303387895,
            0.4941278073848496,
            0.4990412066996574,
            0.5253297487628473,
            0.5672994385230301,
            0.4986191473163304,
            0.49866006851922345,
            0.5002750285496764,
        ],
        "dp": [
            0.008866191,
            0.048201263,
            0.0011568666,
            0.009291172,
            0.019099295,
            0.016055286,
            0.07069677,
            0.020195365,
            0.010416985,
            0.007717788,
        ],
        "ftu": [
            0.010358572,
            0.025298774,
            0.0023240447,
            0.0023240447,
            0.012018621,
            0.0049136877,
            0.03977424,
            0.014276266,
            0.0069720745,
            0.005776882,
        ],
        "dp-f1": [
            0.9208300771543755,
            0.8987726288205816,
            0.9240927039311877,
            0.9143728308682749,
            0.9124605014915191,
            0.9101361910275969,
            0.8835839981157168,
            0.9071731197632769,
            0.9114270826102668,
            0.919700077475956,
        ],
        "dp-auroc": [
            0.6717490082369019,
            0.656300536921136,
            0.6672209786680249,
            0.6593813343042096,
            0.6615257904144599,
            0.6849588224909299,
            0.7045199256135553,
            0.6609056990180551,
            0.6631517923433632,
            0.6651858949382999,
        ],
        "ftu-f1": [
            0.9201854709913487,
            0.9088554179408156,
            0.9235928806529748,
            0.9173290503418785,
            0.9155122521229302,
            0.9148737387083661,
            0.8973215772484631,
            0.9097019530227476,
            0.9128854683850839,
            0.9205328779850049,
        ],
        "ftu-auroc": [
            0.6714058995037614,
            0.6616606519981403,
            0.6669603692643381,
            0.6609172662026489,
            0.6631283536912146,
            0.6876386744709758,
            0.713226250182209,
            0.6622468890533744,
            0.6639235220170393,
            0.6656214326685662,
        ],
    },
    "decaf_dp-y": {
        "precision": [
            0.7570313551338985,
            0.7536975349766822,
            0.7533234859675036,
            0.751937462093133,
            0.7570106088249206,
            0.7554970996897342,
            0.7674468696151637,
            0.7516732686791422,
            0.7511650219298246,
            0.7590781187190138,
        ],
        "recall": [
            0.9904049295774648,
            0.995862676056338,
            0.9427816901408451,
            0.9822183098591549,
            0.9861795774647887,
            0.9860035211267606,
            0.9409330985915493,
            0.9688380281690141,
            0.9648767605633802,
            0.9973591549295775,
        ],
        "f1-score": [
            0.8581343909694149,
            0.8580204778156997,
            0.837471165500254,
            0.8517882361922211,
            0.8565312129668565,
            0.8554953028335752,
            0.8453812084783296,
            0.8465502653642027,
            0.844713316892725,
            0.8620558472190519,
        ],
        "auroc": [
            0.5072294918157595,
            0.4983367434335744,
            0.49747192615150365,
            0.493676722497145,
            0.5071438427864484,
            0.5031368956985154,
            0.5327638465930719,
            0.4930676627331557,
            0.49176270460601446,
            0.5127336315188429,
        ],
        "dp": [
            0.007373154,
            0.004021287,
            0.037154257,
            0.0032939315,
            0.024425507,
            0.011377573,
            0.0037128925,
            0.047318816,
            0.055079162,
            0.0020284057,
        ],
        "ftu": [
            0.010491371,
            0.003917694,
            0.031142056,
            0.006507337,
            0.003386438,
            0.021779537,
            0.023173928,
            0.021978796,
            0.013081014,
            0.00019919872,
        ],
        "dp-f1": [
            0.9204939209575402,
            0.9218667790903103,
            0.8957928936444798,
            0.9185665348720116,
            0.9121853627449953,
            0.9172536317900651,
            0.9146515597948603,
            0.8964855625817217,
            0.8920116025252178,
            0.9250479095466251,
        ],
        "dp-auroc": [
            0.6713837824820869,
            0.6642945252752384,
            0.6560062052592645,
            0.6603009484073109,
            0.6673642396319932,
            0.6668802552366971,
            0.6942682325607731,
            0.6498172704824249,
            0.6468742950451605,
            0.6774234853481654,
        ],
        "ftu-f1": [
            0.9191509133168602,
            0.9219111513791772,
            0.898386221318086,
            0.9171995043360873,
            0.9212778566388492,
            0.9127510672534002,
            0.9063627546273909,
            0.9075491137124423,
            0.9102958151490796,
            0.9258329608688163,
        ],
        "ftu-auroc": [
            0.6706690395976816,
            0.6643175657279445,
            0.6573959071311006,
            0.65959426876656,
            0.6722180452981542,
            0.6644970629648265,
            0.689482102539622,
            0.6556104666995017,
            0.656436003556535,
            0.6778443974814641,
        ],
    },
}

from statistics import harmonic_mean

import numpy as np
import pandas as pd


def result_df(results):
    def formatter(results):
        return f"{np.mean(results):.3f}±{np.std(results):.3f}"

    # cols = ["model"] + list(results["original"].keys())
    cols = [
        "model",
        "precision",
        "recall",
        "f1-score",
        "auroc",
        "ftu",
        "dp",
        "ftu-f1",
        "ftu-auroc",
        "dp-f1",
        "dp-auroc",
    ]
    # rows = list(results.keys())
    rows = ["original"] + [
        f"decaf_{v}" for v in ["nd", "ftu", "cf", "dp", "cf-y", "dp-y"]
    ]
    for row in rows:
        for i in range(10):
            results[row]["dp-f1"][i] = harmonic_mean(
                [1 - results[row]["dp"][i], results[row]["f1-score"][i]]
            )
            results[row]["ftu-f1"][i] = harmonic_mean(
                [1 - results[row]["ftu"][i], results[row]["f1-score"][i]]
            )
            results[row]["dp-auroc"][i] = harmonic_mean(
                [1 - results[row]["dp"][i], results[row]["auroc"][i]]
            )
            results[row]["ftu-auroc"][i] = harmonic_mean(
                [1 - results[row]["ftu"][i], results[row]["auroc"][i]]
            )
    df = pd.DataFrame(np.zeros((len(rows), len(cols))), columns=cols)
    df["model"] = rows
    for model, model_results in results.items():
        for col in cols[1:]:
            df.loc[df["model"] == model, col] = formatter(model_results[col])
    return df


print(result_df(results))
